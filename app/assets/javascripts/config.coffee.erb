
angular.module('Infoluence').config [

 "$stateProvider"
 "$urlRouterProvider"
 "$locationProvider"
 "$compileProvider"
 "$httpProvider"
 ($stateProvider,$urlRouterProvider,$locationProvider,$compileProvider,$httpProvider) ->

  $compileProvider.debugInfoEnabled(false)

  # set csrf token for rails
  for metaEle in angular.element(document).find('meta')
   if angular.element(metaEle).attr('name') == 'csrf-token'
    $httpProvider.defaults.headers.common['X-CSRF-Token'] = angular.element(metaEle).attr('content')
    break

  $stateProvider

  .state "home",
   url: "/"
   #controller: "HomeController"
   templateUrl: "home/home.html"
   resolve:
    postId: [
     "$stateParams"
     ($stateParams) ->
      return $stateParams.postId
    ]

  .state "userpage",
   url: "/:username"
   #controller: "HomeController"
   templateUrl: "userpage/base.html"
   resolve:
    username: [
     "$stateParams"
     ($stateParams) ->
      return $stateParams.username
    ]

  # .state "home.post",
  #  url: "posts/:rootId"
  #  templateUrl: "directive_templates/detail_post.html"
  #  controller: "PostController"
  #  resolve:
  #   rootId: [
  #    "$stateParams"
  #    ($stateParams) ->
  #     return $stateParams.rootId
  #   ]

  ##########################################################
  ##########################################################
   
  $urlRouterProvider.otherwise "/404"
  $locationProvider.html5Mode true

]