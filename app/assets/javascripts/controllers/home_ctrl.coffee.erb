
angular.module('Infoluence').controller 'HomeController', [

 'CookieService'
 'UUID'
 'FeedFactory'

 '$scope'
 '$stateParams'


 (CookieService,UUID,FeedFactory,$scope,$stateParams) ->

  $scope.me = null
  $scope.feed = FeedFactory.feed
  $scope.rootId = "/"

  $scope.feedType = FeedFactory.feedType
  #$$scope.feedType = "" #'/following' for following feed


  $scope.homeInit = =>
   
   $('body').scrollTop()

  $scope.getFeed = =>
   FeedFactory.getFeed($scope.feedType)

  $scope.switchToPublic = =>
   $scope.clear()
   #$scope.feedType = ""
   FeedFactory.switchToPublic()
   $scope.getFeed()

  $scope.switchToFollowing = =>
   $scope.clear()
   #$scope.feedType = "/following"
   FeedFactory.switchToFollowing()
   $scope.getFeed()

  $scope.clear = =>
   FeedFactory.clear()
   $scope.feed = FeedFactory.feed



  # $scope.initialize = =>
  #  $scope.me = CookieService.getUserInfo()
   

  # $scope.publishComment = (post) ->

  #  if $scope.commentContent.length > 0

  #   CommentsFactory.publishComment(post.rootId,$scope.commentContent)

  #   currentTime = new Date().getTime()

  #   if $scope.commentContent.length >= 2000
  #    $scope.commentErrMsg.push "Comment too long.(exceeded 2000 characters)"
  #    return

  #   comment =
  #   	imgUrl:     $scope.imgUrl
  #   	firstName:  CookieService.getCookie("firstName")
  #   	lastName:   CookieService.getCookie("lastName")
  #   	username:   CookieService.getCookie("username")
  #   	content:    $scope.commentContent
  #   	time:       moment(currentTime * 1000).format("L, h:mm:ss a")
  #    timeString: moment.duration((currentTime - currentTime) * 1000).humanize()
  #    guid:       UUID.newguid()
     
  #   if post.commentBool == false
	 #    post.commentBool = true
	 #    post.commentLoaded = true

  #   post.commentList.push comment

  #   $scope.commentContent = ""


 	# $scope.focus = (inputId) =>
 	# 	id = "#commentInput_#{inputId}"
 	# 	$(id).focus()
  #  $scope.commentErrMsg = []


]
